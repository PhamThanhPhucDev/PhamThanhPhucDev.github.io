<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phạm Thành Phúc | Cyber Profile</title>
    <style>
        /* Thêm CSS cho phần trình phát nhạc YouTube */
        .music-player {
            margin: 20px auto;
            padding: 15px;
            border: 1px solid var(--border-color);
            background-color: rgba(0, 0, 0, 0.7);
            max-width: 600px;
            box-shadow: 0 0 10px var(--glow-color);
        }
        
        .music-player h2 {
            margin-top: 0;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 10px;
            text-align: center;
        }
        
        .search-container {
            position: relative;
            margin-bottom: 15px;
        }
        
        .search-container input {
            width: 100%;
            padding: 8px;
            background-color: rgba(0, 0, 0, 0.5);
            border: 1px solid var(--border-color);
            color: white;
            font-family: 'Share Tech Mono', monospace;
        }
        
        .suggestions {
            position: absolute;
            width: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            border: 1px solid var(--border-color);
            border-top: none;
            z-index: 100;
            max-height: 200px;
            overflow-y: auto;
            display: none;
        }
        
        .suggestion-item {
            padding: 8px;
            cursor: pointer;
            border-bottom: 1px solid rgba(0, 255, 0, 0.2);
        }
        
        .suggestion-item:hover {
            background-color: rgba(0, 255, 0, 0.1);
        }
        
        .results-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .track-item {
            padding: 10px;
            border: 1px solid rgba(0, 255, 0, 0.3);
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
        }
        
        .track-item:hover {
            background-color: rgba(0, 255, 0, 0.1);
        }
        
        .track-item.active {
            background-color: rgba(0, 255, 0, 0.2);
            color: var(--border-color);
        }
        
        .track-thumbnail {
            width: 100%;
            aspect-ratio: 1;
            background-size: cover;
            background-position: center;
            margin-bottom: 5px;
        }
        
        .track-title {
            font-size: 0.8em;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .track-artist {
            font-size: 0.7em;
            color: #aaa;
        }
        
        .player-container {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .player-iframe {
            width: 100%;
            height: 200px;
            border: none;
            margin-bottom: 10px;
        }
        
        .player-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
        }
        
        .player-controls button {
            background: none;
            border: 1px solid var(--border-color);
            color: var(--border-color);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .player-controls button:hover {
            background-color: var(--border-color);
            color: black;
        }
        
        .now-playing {
            text-align: center;
            margin-top: 10px;
            font-size: 0.9em;
            color: var(--border-color);
            min-height: 20px;
        }
    </style>
</head>
<body>
    <!-- Các phần hiện có... -->
    
    <div class="container">
        <header>
            <!-- Các phần header hiện có... -->
            
            <div class="social-links">
                <!-- Các liên kết mạng xã hội hiện có... -->
            </div>
            
            <!-- Thêm trình phát nhạc YouTube ở đây -->
            <div class="music-player">
                <h2>TRÌNH PHÁT NHẠC YOUTUBE</h2>
                <div class="search-container">
                    <input type="text" id="searchInput" placeholder="Tìm kiếm bài hát...">
                    <div class="suggestions" id="suggestions"></div>
                </div>
                <div class="results-container" id="resultsContainer"></div>
                <div class="player-container">
                    <div class="player-iframe" id="player"></div>
                    <div class="player-controls">
                        <button id="prevButton">⏮</button>
                        <button id="playButton">▶</button>
                        <button id="nextButton">⏭</button>
                    </div>
                    <div class="now-playing" id="nowPlaying">Chọn bài hát để phát</div>
                </div>
            </div>
        </header>
        
        <!-- Các phần còn lại của trang web... -->
    </div>

    <!-- YouTube IFrame API -->
    <script src="https://www.youtube.com/iframe_api"></script>
    <script>
        // Biến toàn cục
        let player;
        let currentTracks = [];
        let currentTrackIndex = -1;
        let searchTimer;
        let isPlaying = false;

        // Khởi tạo trình phát YouTube
        function onYouTubeIframeAPIReady() {
            player = new YT.Player('player', {
                height: '200',
                width: '100%',
                events: {
                    'onReady': onPlayerReady,
                    'onStateChange': onPlayerStateChange
                }
            });
        }

        function onPlayerReady(event) {
            console.log('Trình phát đã sẵn sàng');
        }

        function onPlayerStateChange(event) {
            if (event.data === YT.PlayerState.ENDED) {
                playNextTrack();
            }
        }

        // Tìm kiếm gợi ý khi nhập
        document.getElementById('searchInput').addEventListener('input', function(e) {
            clearTimeout(searchTimer);
            const query = e.target.value.trim();
            
            if (query.length < 2) {
                document.getElementById('suggestions').style.display = 'none';
                return;
            }
            
            searchTimer = setTimeout(() => {
                fetchSuggestions(query);
            }, 300);
        });

        // Tìm kiếm khi nhấn Enter
        document.getElementById('searchInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                searchTracks(this.value.trim());
                document.getElementById('suggestions').style.display = 'none';
            }
        });

        // Lấy gợi ý tìm kiếm từ YouTube
        async function fetchSuggestions(query) {
            try {
                const response = await fetch(`https://suggestqueries-clients6.youtube.com/complete/search?client=youtube&q=${encodeURIComponent(query)}&ds=yt`);
                const data = await response.text();
                
                // Parse dữ liệu JSONP
                const json = JSON.parse(data.substring(data.indexOf('(') + 1, data.lastIndexOf(')')));
                const suggestions = json[1].map(item => item[0]);
                
                displaySuggestions(suggestions);
            } catch (error) {
                console.error('Lỗi khi lấy gợi ý:', error);
            }
        }

        // Hiển thị gợi ý tìm kiếm
        function displaySuggestions(suggestions) {
            const suggestionsContainer = document.getElementById('suggestions');
            suggestionsContainer.innerHTML = '';
            
            suggestions.slice(0, 5).forEach(suggestion => {
                const item = document.createElement('div');
                item.className = 'suggestion-item';
                item.textContent = suggestion;
                item.addEventListener('click', () => {
                    document.getElementById('searchInput').value = suggestion;
                    searchTracks(suggestion);
                    suggestionsContainer.style.display = 'none';
                });
                suggestionsContainer.appendChild(item);
            });
            
            suggestionsContainer.style.display = suggestions.length > 0 ? 'block' : 'none';
        }

        // Tìm kiếm bài hát trên YouTube
        async function searchTracks(query) {
            if (!query) return;
            
            try {
                // Sử dụng YouTube Data API (cần API key thực)
                // Đây là giải pháp tạm thời cho demo
                const response = await fetch(`https://www.youtube.com/results?search_query=${encodeURIComponent(query)}`);
                const html = await response.text();
                
                // Phân tích HTML để lấy thông tin video (cách này không ổn định)
                const parser = new DOMParser();
                const doc = parser.parseFromString(html, 'text/html');
                const videoElements = doc.querySelectorAll('ytd-video-renderer');
                
                currentTracks = [];
                const resultsContainer = document.getElementById('resultsContainer');
                resultsContainer.innerHTML = '';
                
                // Lấy 3 video đầu tiên
                Array.from(videoElements).slice(0, 3).forEach((element, index) => {
                    const title = element.querySelector('#video-title')?.textContent.trim() || 'Không có tiêu đề';
                    const channel = element.querySelector('.ytd-channel-name a')?.textContent.trim() || 'Không rõ nghệ sĩ';
                    const thumbnail = element.querySelector('img')?.src || '';
                    const videoId = element.querySelector('a#thumbnail')?.href.match(/v=([^&]+)/)?.[1] || '';
                    
                    if (videoId) {
                        currentTracks.push({
                            id: videoId,
                            title: title,
                            artist: channel,
                            thumbnail: thumbnail
                        });
                        
                        const trackItem = document.createElement('div');
                        trackItem.className = 'track-item';
                        trackItem.innerHTML = `
                            <div class="track-thumbnail" style="background-image: url('${thumbnail}')"></div>
                            <div class="track-title">${title}</div>
                            <div class="track-artist">${channel}</div>
                        `;
                        trackItem.addEventListener('click', () => playTrack(index));
                        resultsContainer.appendChild(trackItem);
                    }
                });
                
                if (currentTracks.length === 0) {
                    resultsContainer.innerHTML = '<div class="track-item">Không tìm thấy bài hát</div>';
                }
            } catch (error) {
                console.error('Lỗi khi tìm kiếm bài hát:', error);
                document.getElementById('resultsContainer').innerHTML = '<div class="track-item">Lỗi khi tải dữ liệu</div>';
            }
        }

        // Phát bài hát
        function playTrack(index) {
            if (index < 0 || index >= currentTracks.length) return;
            
            currentTrackIndex = index;
            const track = currentTracks[currentTrackIndex];
            
            // Cập nhật giao diện
            document.querySelectorAll('.track-item').forEach((item, i) => {
                if (i === currentTrackIndex) {
                    item.classList.add('active');
                } else {
                    item.classList.remove('active');
                }
            });
            
            document.getElementById('nowPlaying').textContent = `Đang phát: ${track.title} - ${track.artist}`;
            
            // Phát video YouTube
            player.loadVideoById(track.id);
            isPlaying = true;
            document.getElementById('playButton').textContent = '⏸';
        }

        // Điều khiển trình phát
        document.getElementById('playButton').addEventListener('click', () => {
            if (currentTrackIndex === -1 && currentTracks.length > 0) {
                playTrack(0);
                return;
            }
            
            if (isPlaying) {
                player.pauseVideo();
                document.getElementById('playButton').textContent = '▶';
            } else {
                player.playVideo();
                document.getElementById('playButton').textContent = '⏸';
            }
            isPlaying = !isPlaying;
        });

        document.getElementById('prevButton').addEventListener('click', playPrevTrack);
        document.getElementById('nextButton').addEventListener('click', playNextTrack);

        function playPrevTrack() {
            if (currentTracks.length === 0) return;
            const newIndex = (currentTrackIndex - 1 + currentTracks.length) % currentTracks.length;
            playTrack(newIndex);
        }

        function playNextTrack() {
            if (currentTracks.length === 0) return;
            const newIndex = (currentTrackIndex + 1) % currentTracks.length;
            playTrack(newIndex);
        }

        // Ẩn gợi ý khi click ra ngoài
        document.addEventListener('click', (e) => {
            if (!e.target.closest('.search-container')) {
                document.getElementById('suggestions').style.display = 'none';
            }
        });

        // Các script hiện có khác...
    </script>
</body>
</html>
